{"ast":null,"code":"var _jsxFileName = \"/Users/ioannischionas/Code/springboot/cineProject/demo-frontend/src/pages/Reservations.js\",\n    _s = $RefreshSig$();\n\nimport { useState, useEffect } from \"react\";\nimport useAxiosPrivate from \"../hooks/useAxiosPrivate\";\nimport { useNavigate, useLocation } from \"react-router-dom\";\nimport Navbar from \"../components/Navbar\";\nimport useAuth from \"../hooks/useAuth\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Reservations = () => {\n  _s();\n\n  const {\n    auth\n  } = useAuth();\n  const [reservations, setReservations] = useState();\n  const axiosPrivate = useAxiosPrivate();\n  const navigate = useNavigate();\n  const location = useLocation();\n  const [isAuthorized, setIsAuthorized] = useState(false);\n  useEffect(() => {\n    var _auth$roles;\n\n    setIsAuthorized(auth === null || auth === void 0 ? void 0 : (_auth$roles = auth.roles) === null || _auth$roles === void 0 ? void 0 : _auth$roles.find(role => role === \"EMPLOYER\" || role === \"ADMIN\"));\n  }, []);\n\n  const onDelete = async id => {\n    let isMounted = true;\n    const controller = new AbortController();\n\n    const deleteReservation = async () => {\n      try {\n        const response_tmp = await axiosPrivate.delete(`reservations/${id}`, {\n          signal: controller.signal\n        });\n        const response = await axiosPrivate.get('reservations', {\n          signal: controller.signal\n        });\n        console.log(response.data);\n        console.log(response_tmp.data);\n        isMounted && setReservations(response.data);\n      } catch (err) {\n        if ((err === null || err === void 0 ? void 0 : err.code) !== 'ERR_CANCELED') {\n          console.error(err);\n          navigate('/login', {\n            state: {\n              from: location\n            },\n            replace: true\n          });\n        }\n      }\n    };\n\n    deleteReservation();\n    return () => {\n      isMounted = false;\n      controller.abort();\n    };\n  };\n\n  const loadReservations = async () => {\n    let isMounted = true;\n    const controller = new AbortController();\n\n    const getReservations = async () => {\n      try {\n        const response = await axiosPrivate.get('reservations', {\n          signal: controller.signal\n        });\n        console.log(response.data);\n        isMounted && setReservations(response.data);\n      } catch (err) {\n        if ((err === null || err === void 0 ? void 0 : err.code) !== 'ERR_CANCELED') {\n          console.error(err);\n          navigate('/login', {\n            state: {\n              from: location\n            },\n            replace: true\n          });\n        }\n      }\n    };\n\n    getReservations();\n    return () => {\n      isMounted = false;\n      controller.abort();\n    };\n  };\n\n  useEffect(() => {\n    loadReservations();\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"article\", {\n    children: [/*#__PURE__*/_jsxDEV(Navbar, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"List of Reservations\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 17\n      }, this), reservations !== null && reservations !== void 0 && reservations.length ? /*#__PURE__*/_jsxDEV(\"table\", {\n        children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n          children: /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: [/*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Id\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 98,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Movie\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 99,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"User\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 100,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Date\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 101,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Action\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 102,\n              columnNumber: 37\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 97,\n            columnNumber: 33\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n          children: reservations.map((reservation, index) => {\n            var _reservation$reserved, _reservation$reserved2, _reservation$reserved3, _reservation$reserved4;\n\n            return /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                children: reservation === null || reservation === void 0 ? void 0 : reservation.id\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 108,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: reservation === null || reservation === void 0 ? void 0 : (_reservation$reserved = reservation.reservedShowing) === null || _reservation$reserved === void 0 ? void 0 : (_reservation$reserved2 = _reservation$reserved.showingMovie) === null || _reservation$reserved2 === void 0 ? void 0 : _reservation$reserved2.title\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 109,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: reservation === null || reservation === void 0 ? void 0 : (_reservation$reserved3 = reservation.reservedUser) === null || _reservation$reserved3 === void 0 ? void 0 : _reservation$reserved3.email\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 110,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: reservation === null || reservation === void 0 ? void 0 : (_reservation$reserved4 = reservation.reservedShowing) === null || _reservation$reserved4 === void 0 ? void 0 : _reservation$reserved4.showingDate\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 111,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: /*#__PURE__*/_jsxDEV(\"button\", {\n                  disabled: !isAuthorized ? true : false,\n                  onClick: () => onDelete(reservation === null || reservation === void 0 ? void 0 : reservation.id),\n                  children: \"Delete\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 113,\n                  columnNumber: 45\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 112,\n                columnNumber: 41\n              }, this)]\n            }, index, true, {\n              fileName: _jsxFileName,\n              lineNumber: 107,\n              columnNumber: 37\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 29\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 25\n      }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [/*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 28\n        }, this), \"There are no registered reservations\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 25\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        children: \"Make new Reservation\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 88,\n    columnNumber: 9\n  }, this);\n};\n\n_s(Reservations, \"oStCXgTOyE+DkuaJKgpV1X4iqAg=\", false, function () {\n  return [useAuth, useAxiosPrivate, useNavigate, useLocation];\n});\n\n_c = Reservations;\nexport default Reservations;\n\nvar _c;\n\n$RefreshReg$(_c, \"Reservations\");","map":{"version":3,"names":["useState","useEffect","useAxiosPrivate","useNavigate","useLocation","Navbar","useAuth","Reservations","auth","reservations","setReservations","axiosPrivate","navigate","location","isAuthorized","setIsAuthorized","roles","find","role","onDelete","id","isMounted","controller","AbortController","deleteReservation","response_tmp","delete","signal","response","get","console","log","data","err","code","error","state","from","replace","abort","loadReservations","getReservations","length","map","reservation","index","reservedShowing","showingMovie","title","reservedUser","email","showingDate"],"sources":["/Users/ioannischionas/Code/springboot/cineProject/demo-frontend/src/pages/Reservations.js"],"sourcesContent":["import { useState, useEffect } from \"react\";\nimport useAxiosPrivate from \"../hooks/useAxiosPrivate\";\nimport { useNavigate, useLocation } from \"react-router-dom\";\nimport Navbar from \"../components/Navbar\";\nimport useAuth from \"../hooks/useAuth\";\n\n\n\n\nconst Reservations = () => {\n\n    const { auth } = useAuth();\n    const [reservations, setReservations] = useState();\n    const axiosPrivate = useAxiosPrivate();\n    const navigate = useNavigate();\n    const location = useLocation();\n\n    const [isAuthorized,setIsAuthorized] = useState(false);\n\n    useEffect(() => {\n        setIsAuthorized(auth?.roles?.find(role => role === \"EMPLOYER\" || role === \"ADMIN\"));\n    }, [])\n\n    const onDelete = async (id) => {\n        let isMounted = true;\n        const controller = new AbortController();\n\n        const deleteReservation = async () => {\n            try {\n                const response_tmp = await axiosPrivate.delete(`reservations/${id}`, {\n                    signal: controller.signal\n                });\n                const response = await axiosPrivate.get('reservations', {\n                    signal: controller.signal\n                });\n                console.log(response.data);\n                console.log(response_tmp.data);\n                isMounted && setReservations(response.data);\n            } catch (err) {\n                if (err?.code !== 'ERR_CANCELED') {\n                    console.error(err);\n                    navigate('/login', { state: { from: location }, replace: true });\n                }\n            }\n        }\n\n        deleteReservation();\n\n        return () => {\n            isMounted = false;\n            controller.abort();\n        }\n\n    };\n\n    const loadReservations = async () => {\n        let isMounted = true;\n        const controller = new AbortController();\n\n        const getReservations = async () => {\n            try {\n                const response = await axiosPrivate.get('reservations', {\n                    signal: controller.signal\n                });\n                console.log(response.data);\n                isMounted && setReservations(response.data);\n            } catch (err) {\n                if (err?.code !== 'ERR_CANCELED') {\n                    console.error(err);\n                    navigate('/login', { state: { from: location }, replace: true });\n                }\n            }\n        }\n\n        getReservations();\n\n        return () => {\n            isMounted = false;\n            controller.abort();\n        }\n    };\n\n    useEffect(() => {\n        loadReservations();\n    }, []);\n\n    return (\n        <article>\n            <Navbar/>\n            <br/>\n            <section>\n                <h2>List of Reservations</h2>\n                {reservations?.length\n                    ? (\n                        <table>\n                            <thead>\n                                <tr>\n                                    <th>Id</th>\n                                    <th>Movie</th>\n                                    <th>User</th>\n                                    <th>Date</th>\n                                    <th>Action</th>\n                                </tr>\n                            </thead>\n                            <tbody>\n                                {reservations.map((reservation, index) => (\n                                    <tr key={index}>\n                                        <td>{reservation?.id}</td>\n                                        <td>{reservation?.reservedShowing?.showingMovie?.title}</td>\n                                        <td>{reservation?.reservedUser?.email}</td>\n                                        <td>{reservation?.reservedShowing?.showingDate}</td>\n                                        <td>\n                                            <button\n                                                disabled={!isAuthorized ? true : false}\n                                                onClick={() => onDelete(reservation?.id)}\n                                            >Delete</button></td>\n                                    </tr>\n                                ))}\n                            </tbody>\n                        </table>\n                    ) : <p><br />There are no registered reservations</p>\n                }\n                <button>Make new Reservation</button>\n            </section>\n        </article>\n    );\n};\nexport default Reservations;"],"mappings":"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"},"metadata":{},"sourceType":"module"}